{% extends 'base.html.twig' %}

{% block title %}Challenge{% endblock %}

{% block body %}
    <div class="text-center p-5">
        <h1>Challenge</h1>
    </div>
    <div class="container-fluid col-10">
        <div class="card text-white bg-dark mb-3">
        <div class="card-header h4 font-weight-bold">{{ challenge.name }}</div>
        <div class="card-body">
            <p class="card-text"><b>Entreprise ðŸ”¹ </b>
                {% if  challenge.getEnterprise() != null %}
                    {{ challenge.getEnterprise().getName() }}
                {% else %}Challenge reliÃ© Ã  aucune entreprise.
                {% endif %}</p>
            <p class="card-text"><b>Engagement ðŸ”¹ </b>
                {% if  challenge.getEngagement() != null %}
                    {{ challenge.getEngagement().getName() }}
                {% else %}Challenge reliÃ© Ã  aucun engagement.
                {% endif %}</p>
            <p class="card-text"><b>Description ðŸ”¹ </b>{{ challenge.description }}</p>
            <p class="card-text"><b>Commentaire ðŸ”¹ </b>{{ challenge.comment }}</p>
            <p class="card-text"><b>Document ðŸ”¹ </b><a href="{{ asset('challenge.documents') }}" class="text-success">{{ challenge.documents }}</a></p>
            <p class="card-text"><b>DÃ©positaire ðŸ”¹ </b>{{ challenge.getDepositary().getFullName() }}</p>
            <p class="card-text"><b>Nombre de Votes ðŸ”¹ </b><b class="h3 text-success">{{ likes }}</b></p>
            {% if is_granted('ROLE_CONSUMER') or is_granted('ROLE_EXPERT') %}
                {% set vote = false %}
                {% for like in app.user.likes %}
                    {% if like.name == challenge.name %}
                        {% set vote = true %}
                    {% endif %}
                {% endfor %}
                {% if vote == true %}
                    <a href="{{ path('vote_challenge', { 'id': challenge.id }) }}"
                    class="card-text disabled btn btn-success font-weight-bold text-dark card-link w-100">Vous avez dÃ©ja votÃ© pour ce challenge</a>
                {% else %}
                    <a href="{{ path('vote_challenge', { 'id': challenge.id }) }}"
                    class="card-text btn btn-success text-dark font-weight-bold card-link w-100">Voter pour ce challenge</a>
                {% endif %}
            {% else %}
            <div class="text-right">
                <a href="{{ path('app_login') }}"
                class=" card-text btn btn-success text-dark font-weight-bold card-link">Connectez-vous pour voter</a>
            </div>
            {% endif %}
        </div>
      </div>
    </div>
{% endblock %}
